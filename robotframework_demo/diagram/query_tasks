demon=# select *from task where status='running';
  id   |     type     |                                         data                                          | ret_data | status  | error_msg | retry | host_id | scheduled |            create             |            update             |            execute            | finish |           heartbeat           | retried | retry_type | host_role |          not_before           | priority 
-------+--------------+---------------------------------------------------------------------------------------+----------+---------+-----------+-------+---------+-----------+-------------------------------+-------------------------------+-------------------------------+--------+-------------------------------+---------+------------+-----------+-------------------------------+----------
 13814 | DeleteTarget | {"access_path":{"id":115},"action_log":{"id":2019},"force":false,"target":{"id":196}} |          | running |           |     0 |       1 | f         | 2018-11-14 06:19:29.14958+00  | 2018-11-14 06:19:29.149583+00 | 2018-11-14 06:19:32.568658+00 |        | 2018-11-14 06:19:32.568658+00 | f       |            |           | 2018-11-14 06:19:29.149551+00 |        0
 13813 | DeleteTarget | {"access_path":{"id":115},"action_log":{"id":2018},"force":false,"target":{"id":197}} |          | running |           |     0 |       1 | f         | 2018-11-14 06:19:28.943081+00 | 2018-11-14 06:19:28.943084+00 | 2018-11-14 06:19:32.552454+00 |        | 2018-11-14 06:19:32.552454+00 | f       |            |           | 2018-11-14 06:19:28.943051+00 |        0
(2 rows)

demon=# select *from mapping_group where access_path_id=113;
 id | access_path_id | client_group_id | status |            create             |            update
----+----------------+-----------------+--------+-------------------------------+-------------------------------
 72 |            113 |              62 | active | 2018-11-14 11:09:17.806595+00 | 2018-11-14 11:09:24.944334+00
 73 |            113 |              61 | active | 2018-11-14 11:09:43.759786+00 | 2018-11-14 11:09:49.229014+00
(2 rows)

demon=# select *from target where access_path_id=113;
 id  | host_id | board | port |                    iqn                    | access_path_id | status |            create             |            update
-----+---------+-------+------+-------------------------------------------+----------------+--------+-------------------------------+-------------------------------
 192 |       1 |     0 | 3260 | iqn.2018-10.node-233.113:1140dfe1a88014f5 |            113 | active | 2018-10-31 08:35:01.606738+00 | 2018-10-31 08:35:04.047158+00
 193 |       2 |     1 | 3260 | iqn.2018-10.node-234.113:185a6dd1389b9860 |            113 | active | 2018-10-31 08:35:08.365004+00 | 2018-10-31 08:35:13.919392+00
(2 rows)

demon=# SELECT target_id, client_id, lun_id, status FROM client_lun_mapping WHERE target_id IN (192,193) ORDER BY target_id, client_id, lun_id;
 target_id | client_id | lun_id | status
-----------+-----------+--------+--------
       192 |        85 |    196 | active
       192 |        85 |    197 | active
       192 |        86 |    196 | active
       192 |        86 |    197 | active
       192 |        87 |    196 | active
       192 |        87 |    197 | active
       193 |        85 |    196 | active
       193 |        85 |    197 | active
       193 |        86 |    196 | active
       193 |        86 |    197 | active
       193 |        87 |    196 | active
       193 |        87 |    197 | active

demon=# SELECT lun.id FROM lun JOIN mapping_group_volumes mpv ON lun.volume_id=mpv.volume_id WHERE mpv.mapping_group_id=72 ORDER BY lun.id;
 id  
-----
 196
 197


(2 rows)
demon=# select * from task where status='running';
  id  |   type    |                   data                   | ret_data | status  | error_msg | retry | host_id | scheduled |            create             |            update             |            execute            | finish |           heartbeat           | retried | retry_type | host_role |          not_before           | priority
------+-----------+------------------------------------------+----------+---------+-----------+-------+---------+-----------+-------------------------------+-------------------------------+-------------------------------+--------+-------------------------------+---------+------------+-----------+-------------------------------+----------
 1901 | CreateOsd | {"action_log":{"id":88},"osd":{"id":35}} |          | running |           |     0 |       1 | f         | 2018-11-19 05:52:58.908938+00 | 2018-11-19 05:52:58.908939+00 | 2018-11-19 05:53:46.326114+00 |        | 2018-11-19 05:53:42.920879+00 | f       |            |           | 2018-11-19 05:52:58.908924+00 |        0
 1900 | CreateOsd | {"action_log":{"id":87},"osd":{"id":34}} |          | running |           |     0 |       2 | f         | 2018-11-19 05:52:57.856755+00 | 2018-11-19 05:52:57.856757+00 | 2018-11-19 05:53:46.301069+00 |        | 2018-11-19 05:54:26.644289+00 | f       |            |           | 2018-11-19 05:52:57.856738+00 |        0
(2 rows)





#创建索引盘
demon=# select * from task where status='running';
  id  |    type    |                            data                             | ret_data | status  | error_msg | retry | host_id | scheduled |            create             |            update             |            execute            | finish |           heartbeat           | retried | retry_type | host_role |         not_before          | priority
------+------------+-------------------------------------------------------------+----------+---------+-----------+-------+---------+-----------+-------------------------------+-------------------------------+-------------------------------+--------+-------------------------------+---------+------------+-----------+-----------------------------+----------
 1946 | CreatePool | {"action_log":{"id":89},"osd_ids":[35,34],"pool":{"id":34}} |          | running |           |     0 |       1 | f         | 2018-11-19 06:03:00.244912+00 | 2018-11-19 06:03:00.244914+00 | 2018-11-19 06:03:02.554571+00 |        | 2018-11-19 06:03:02.554571+00 | f       |            |           | 2018-11-19 06:03:00.2449+00 |        0
(1 row)

demon=# select * from task where status='running';
  id  |    type    |                                                                           data                                                                           | ret_data | status  | error_msg | retry | host_id | scheduled |            create             |            update             |            execute            | finish |           heartbeat           | retried | retry_type | host_role |          not_before           | priority
------+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+-----------+-------+---------+-----------+-------------------------------+-------------------------------+-------------------------------+--------+-------------------------------+---------+------------+-----------+-------------------------------+----------
 1946 | CreatePool | {"action_log":{"id":89},"osd_ids":[35,34],"pool":{"id":34}}                                                                                              |          | running |           |     0 |       1 | f         | 2018-11-19 06:03:00.244912+00 | 2018-11-19 06:03:00.244914+00 | 2018-11-19 06:03:02.554571+00 |        | 2018-11-19 06:03:22.574708+00 | f       |            |           | 2018-11-19 06:03:00.2449+00   |        0
 1947 | UpdateOsd  | {"no_notification":true,"osd":{"id":35,"qos":{"id":34,"mode":1,"bandwidth":10485760,"bandwidth_max":0,"client_threshold":0,"recovery_rate_type":"low"}}} |          | running |           |     0 |       1 | f         | 2018-11-19 06:03:19.740218+00 | 2018-11-19 06:03:19.74022+00  | 2018-11-19 06:03:22.572634+00 |        | 2018-11-19 06:03:22.572634+00 | f       |            |           | 2018-11-19 06:03:19.740204+00 |        0
(2 rows)

demon=# select * from task where status='running';
  id  |    type    |                            data                             | ret_data | status  | error_msg | retry | host_id | scheduled |            create             |            update             |            execute            | finish |           heartbeat           | retried | retry_type | host_role |         not_before          | priority
------+------------+-------------------------------------------------------------+----------+---------+-----------+-------+---------+-----------+-------------------------------+-------------------------------+-------------------------------+--------+-------------------------------+---------+------------+-----------+-----------------------------+----------
 1946 | CreatePool | {"action_log":{"id":89},"osd_ids":[35,34],"pool":{"id":34}} |          | running |           |     0 |       1 | f         | 2018-11-19 06:03:00.244912+00 | 2018-11-19 06:03:00.244914+00 | 2018-11-19 06:03:02.554571+00 |        | 2018-11-19 06:03:22.574708+00 | f       |            |           | 2018-11-19 06:03:00.2449+00 |        0
(1 row)

demon=# select * from task where status='running';
  id  |    type    |                                                                           data                                                                           | ret_data | status  | error_msg | retry | host_id | scheduled |            create             |            update             |            execute            | finish |           heartbeat           | retried | retry_type | host_role |          not_before           | priority
------+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+-----------+-------+---------+-----------+-------------------------------+-------------------------------+-------------------------------+--------+-------------------------------+---------+------------+-----------+-------------------------------+----------
 1946 | CreatePool | {"action_log":{"id":89},"osd_ids":[35,34],"pool":{"id":34}}                                                                                              |          | running |           |     0 |       1 | f         | 2018-11-19 06:03:00.244912+00 | 2018-11-19 06:03:00.244914+00 | 2018-11-19 06:03:02.554571+00 |        | 2018-11-19 06:04:02.574662+00 | f       |            |           | 2018-11-19 06:03:00.2449+00   |        0
 1948 | UpdateOsd  | {"no_notification":true,"osd":{"id":34,"qos":{"id":34,"mode":1,"bandwidth":10485760,"bandwidth_max":0,"client_threshold":0,"recovery_rate_type":"low"}}} |          | running |           |     0 |       2 | f         | 2018-11-19 06:04:03.485873+00 | 2018-11-19 06:04:03.485875+00 | 2018-11-19 06:04:51.321408+00 |        | 2018-11-19 06:04:51.321408+00 | f       |            |           | 2018-11-19 06:04:03.485854+00 |        0
(2 rows)

demon=# select * from task where status='running';
 id | type | data | ret_data | status | error_msg | retry | host_id | scheduled | create | update | execute | finish | heartbeat | retried | retry_type | host_role | not_before | priority
----+------+------+----------+--------+-----------+-------+---------+-----------+--------+--------+---------+--------+-----------+---------+------------+-----------+------------+----------
(0 rows)

demon=# select * from task where status='running';
 id  |    type    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                 data                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | ret_data | status  | error_msg | retry | host_id | scheduled |            create             |            update             |            execute            | finish |          heartbeat           | retried | retry_type | host_role |          not_before           | priority
-----+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+-----------+-------+---------+-----------+-------------------------------+-------------------------------+-------------------------------+--------+------------------------------+---------+------------+-----------+-------------------------------+----------
 158 | CreateHost | {"action_log":{"id":17},"host":{"id":4,"protection_domain":{"id":1,"name":"default","description":"The first protection domain","placement_node":{"id":1,"name":"","type":"","parent":null,"create":"0001-01-01T00:00:00Z","update":"0001-01-01T00:00:00Z"},"status":"active","create":"2018-11-19T16:11:10.923862Z","update":"2018-11-19T16:11:10.923865Z"},"name":"ceph-2","roles":"admin,monitor,block_storage_gateway","type":"storage_server","public_ips":"10.255.102.74","private_ip":"10.255.103.74","admin_ip":"10.255.101.74","gateway_ips":"10.255.102.74","description":"","vendor":"","model":"","cpu_model":"","cores":0,"memory_kbyte":0,"os":"","rack":"","status":"installing","action_status":"active","up":true,"clock_diff":0,"enclosures":null,"create":"2018-11-20T11:23:54.71361236+08:00","update":"2018-11-20T11:23:54.713615418+08:00","fcports":null,"disk_num":0,"is_master_db":false,"root_disk":null}} |          | running |           |     0 |       1 | f         | 2018-11-20 03:23:54.721278+00 | 2018-11-20 03:23:54.721281+00 | 2018-11-20 03:23:59.403486+00 |        | 2018-11-20 03:24:39.45715+00 | f       |            |           | 2018-11-20 03:23:54.721238+00 |        0
(1 row)
